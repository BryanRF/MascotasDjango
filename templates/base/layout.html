{% load static %}
<!DOCTYPE html>
<html lang="es-ES" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <!-- ===============================================-->
  <!--    Document Title-->
  <!-- ===============================================-->
  <title>Huellitas Sipanenses üò∫üê∂</title>


  <!-- ===============================================-->
  <!--    Favicons-->
  <!-- ===============================================-->
  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'assets/img/favicons/apple-touch-icon.png' %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'assets/img/favicons/favicon-32x32.png' %}">
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'assets/img/favicons/favicon-16x16.png' %}">
  <link rel="shortcut icon" type="image/x-icon" href="{% static 'assets/img/favicons/favicon.ico' %}">
  <link rel="manifest" href="{% static 'assets/img/favicons/manifest.json' %}">
  <meta name="msapplication-TileImage" content="{% static 'assets/img/favicons/mstile-150x150.png' %}">
  <meta name="theme-color" content="#ffffff">
  <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
/>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- ===============================================-->
  <!--    Stylesheets-->
  <!-- ===============================================-->
  <link href="{% static 'assets/css/theme.css' %}" rel="stylesheet" />

</head>
<style>
  .custom-badge {
    display: inline-block;
    padding: 0.25em 0.4em;
    font-size: 75%;
    font-weight: 700;
    line-height: 1;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: 0.25rem;
    background-color: #6c757d;
    color: #ffffff;
}
.mascota-container {
    height: 400px; /* Ajusta el valor seg√∫n tus necesidades */
}
.mascota-container img {
    max-height: 100%;
}
.mascota-container h5,
.mascota-container p {
    max-height: 50px; /* Ajusta el valor seg√∫n tus necesidades */
    overflow: hidden;
}
</style>

<body>

  <!-- ===============================================-->
  <!--    Main Content-->
  <!-- ===============================================-->
  <main class="main" id="top">
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top" data-navbar-on-scroll="data-navbar-on-scroll">
      <div class="container"><a class="navbar-brand d-inline-flex" href="index.html"><img class="d-inline-block"
            src="{% static 'assets/img/gallery/logo.svg' %}" alt="logo" /><span
            class="text-1000 fs-3 fw-bold ms-2 text-gradient">Huellitas Sipanenses</span></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span
            class="navbar-toggler-icon"> </span></button>
        <div class="collapse navbar-collapse border-top border-lg-0 my-2 mt-lg-0" id="navbarSupportedContent">
          <div class="mx-auto pt-5 pt-lg-0 d-block d-lg-none d-xl-block">
            <p class="mb-0 fw-bold text-lg-center">Ubicacion: <i
                class="fas fa-map-marker-alt text-warning mx-2"></i><span class="fw-normal">Universidad </span><span>
                Se√±or de sipan</span></p>
          </div>
          <form class="d-flex mt-4 mt-lg-0 ms-lg-auto ms-xl-0">
           
            {% if user.is_authenticated %}
                    <a href="#"  class="btn btn-white shadow-warning text-warning">{{ user.username }}</a>
                    <button id="registerButton" class="btn btn-white shadow-warning text-warning" type="button"> <i
                      class="fas fa-user me-2" href="{% url 'logout_view' %}" ></i>Cerrar Sesi√≥n</button>
                {% else %}
                    
                    <button id="registerButton" class="btn btn-white shadow-warning text-warning" type="button"> <i
                      class="fas fa-user me-2"></i>Registrate</button>
                    <button id="loginButton" class="btn btn-white shadow-warning text-warning" type="button"> <i
                      class="fas fa-user me-2"></i>Ingresa</button>
                {% endif %}
            
          </form>
        </div>
      </div>
    </nav>


     {% block content %}
      {% endblock %} 

    <!-- <section> close ============================-->
    <!-- ============================================-->


    <!-- <section> close ============================-->
    <!-- ============================================-->


  </main>
  <!-- ===============================================-->
  <!--    End of Main Content-->
  <!-- ===============================================-->




  <!-- ===============================================-->
  <!--    JavaScripts-->
  <!-- ===============================================-->
  <script src="{% static 'vendors/@popperjs/popper.min.js' %}"></script>
  <script src="{% static 'vendors/bootstrap/bootstrap.min.js' %}"></script>
  <script src="{% static 'vendors/is/is.min.js' %}"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=window.scroll"></script>
  <script src="{% static 'vendors/fontawesome/all.min.js' %}"></script>
  <script src="{% static 'assets/js/theme.js' %}"></script>

  <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@200;300;400;600;700;900&amp;display=swap"
    rel="stylesheet">
    <script>
      document.getElementById('registerButton').addEventListener('click', function() {
        Swal.fire({
          title: 'Registro de Usuario ',
          html:
          '<input id="swal-input1" class="swal2-input"  placeholder="Usuario" required>' +
          '<input id="swal-input2" class="swal2-input"  placeholder="Contrase√±a" type="password" required>' +
          '<input id="swal-input3" class="swal2-input"  placeholder="Nombre Completo" required>' +
          '<input id="swal-input4" class="swal2-input"  placeholder="Tel√©fono" required>' +
          '<input id="swal-input5" class="swal2-input" placeholder="DNI" required>' +
          '<input id="swal-input6" class="swal2-input" placeholder="Email" required>' +
          '<input id="swal-input7" class="swal2-input"  type="date" required>' +
          '<select id="swal-input8" class="swal2-input" required>' +
            '<option value="masculino" >Masculino</option>' +
            '<option value="femenino">Femenino</option>' +
            '<option value="otro">Otro</option>' +
          '</select>',
          showCancelButton: true,
          clickOutsideToClose: false, // Evita que se cierre al hacer clic fuera
          confirmButtonText: 'Registrar',
          preConfirm: () => {
            const username = Swal.getPopup().querySelector('#swal-input1').value;
            const password = Swal.getPopup().querySelector('#swal-input2').value;
            const nombre = Swal.getPopup().querySelector('#swal-input3').value;
            const telefono = Swal.getPopup().querySelector('#swal-input4').value;
            const dni = Swal.getPopup().querySelector('#swal-input5').value;
            const email = Swal.getPopup().querySelector('#swal-input6').value;
            const fechaNacimiento = Swal.getPopup().querySelector('#swal-input7').value;
            const genero = Swal.getPopup().querySelector('#swal-input8').value;
        
            // Construye los datos que enviar√°s al servidor
            const data = {
                username: username,
                password: password,
                nombre: nombre,
                telefono: telefono,
                dni: dni,
                email: email,
                fechaNacimiento: fechaNacimiento,
                genero: genero
            };
            console.log(data)
            // Realiza la solicitud fetch
            fetch('api/registro_usuario/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCookie('csrftoken')
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
              if (data.success) {
                  Swal.fire({
                      icon: 'success',
                      title: 'Registro exitoso',
                      text: '¬°Tu registro ha sido exitoso!',
                      showConfirmButton: false,
                      timer: 2000
                  });
                  // Aqu√≠ puedes hacer lo que necesites despu√©s de registrar los datos
              } else {
                  Swal.fire({
                      icon: 'error',
                      title: 'Error',
                      text: 'Ocurri√≥ un error durante el registro',
                  });
              }
          })
          
            .catch(error => console.error('Error:', error));
        }
        
        })
      });
      document.getElementById('loginButton').addEventListener('click', function() {
        Swal.fire({
            title: 'Inicio de Sesi√≥n',
            html:
            '<input id="swal-username" class="swal2-input" placeholder="Usuario o Correo Electr√≥nico">' +
            '<input id="swal-password" class="swal2-input" placeholder="Contrase√±a" type="password">',
            showCancelButton: true,
            confirmButtonText: 'Iniciar Sesi√≥n',
            preConfirm: () => {
                const username_or_email = Swal.getPopup().querySelector('#swal-username').value;
                const password = Swal.getPopup().querySelector('#swal-password').value;
    
                const data = {
                    username_or_email: username_or_email,
                    password: password
                };
    
                fetch('api/login/', {
                    method: 'POST',
                    headers: {
                      'Content-Type': 'application/json',
                        'X-CSRFToken': getCookie('csrftoken')
                    },
                    body: JSON.stringify(data)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        Swal.fire({
                            icon: 'success',
                            title: 'Inicio de Sesi√≥n Exitoso',
                            text: '¬°Bienvenido!',
                            showConfirmButton: false,
                            timer: 2000
                        });
                        location.reload();
                        // Aqu√≠ puedes redirigir al usuario o hacer lo que necesites despu√©s del inicio de sesi√≥n
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Error',
                            text: data.error,
                        });
                    }
                })
                .catch(error => console.error('Error:', error));
            }
        });
    });
    
      </script>
</body></html>
